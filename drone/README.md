# Drone application

## Repo structure
1. ./dataset/
    - Folder containing the dataset used for training and testing eventually relative to different scenario.

2. ./dataset_generation/
    - dataset_pargen.py : script to generate the datatsets
    - preprocessing.py : pre-processing script to convert the dataset generated by dataset_pargen.py in torch Tensors

3. ./decision_transformer/
    - ./saved_files/checkpoints : directory for transformer's models
    - art_closed_loop.py : classes to use transformers in closed-loop (CLOSED-LOOP)
    - art.py : class definition of the transformer (OPEN-LOOP)
    - dagger_training_tracker.ipynb : notebook to keep track of training progresses (both OPEN-LOOP and CLOSED-LOOP)
    - dagger_training.py : DAGGER training to fina tune the open-loop model on closed-loop data (CLOSED-LOOP)
    - main_eval_compact.ipynb : notebook to test the open-loop model (OPEN-LOOP)
    - main_train.ipynb : notebook to try the open-loop training in an interactive way (OPEN-LOOP) --> not sure it's updated
    - main_train.py : open-loop training script (OPEN-LOOP)
    - manage.py : file defining Dataset classes and functions to quickly intercat with the data and the transformer (OPEN-LOOP)
    - self_training_minimum.py : self-training script to retrain the transformer on a dataset augmented with samples generated by the transformer itself (OPEN-LOOP, but of secondary importance)
    - test_closed_loop.ipynb : notebook to test the functioning of OPEN-LOOP warmstarting+optimization (first cells of the notebook) and CLOSED-LOOP receding-horizon control (second half of the cells)

4. ./dynamics/
    - QuadEnv.py : class defining the interactive environment for usage in cloed-loop (CLOSED-LOOP)
    - quadrotor_old.py : old file, to be eliminated
    - Quadrotor:v1.ipynb : notebook to test functionalities of quadrotor.py
    - quadrotor.py : class definition of the quadrotor dynamics and optimization problem

5. ./optimization/
    - dagger_analysis_plotting.ipynb : notebook to plot results from the planning horizon analysis (CLOSED-LOOP)
    - planning_horizon_analysis_dagger.py : scipt to perform the analysis of closed-loop performances varying the planning horizon (CLOSED-LOOP)
    - plotting_warmstarting_analysis.ipynb : notebook to plot warmstarting analysis (OPEN-LOOP)
    - quad_scenario.py : definition of quadrototr propertes, obstacle field and scenario to use for the analysis (OPEN-LOOP / CLOSED-LOOP)
    - warmstarting_analysis.py : script to analyse the warmstarting performances of the transformer compared to convex-relaxation (OPEN-LOOP)

## Suggestions
1. Paste dataset_folder in ./datatset/
2. Paste transformer model in ./decision_transformer/saved_files/checkpoints/
3. Start using main_eval_compact.ipynb for an easy interface with the dataset and the transformer (make sure to specify the correct dataset_scenario variable in quad_scenario.py, e.g. if the dataset used is "random_target_forest", the dataset_scenario variable in quad_scenario.py should be "/random_target_forest")
4. Look at the manage.py file for a more in-depth comprehension on how to import datasets/model and use the model at inference
5. Look at main_train.py for a more in-depth comprehension on hor to train the model which is available in art.py
6. Look at dataset_pargen.py and preprocessing.py to understand how to create the datasets